import{r as d,g as s,F as h,j as e,p as T}from"./react-fd5b3f8c.js";import{s as J}from"./collector.module-b0079d28.js";import{b as y,d as C,r as N,c as b,O as M,p as R,j as E,t as k,P as U,Q as L,R as Y,x as w}from"./index-32e1ab72.js";import{J as P,K as I,h as q,k as f,ar as z,a2 as A,S as G,aj as g,as as H,at as K}from"./vendor-29be4ff8.js";import{I as Q}from"./index-1e5bcb3c.js";import{a as W,u as V}from"./react-redux-0fe31567.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-f202c9ff.js";const X=({id:u})=>{const a=b("collector",J),[i,m]=d.exports.useReducer(p,[]),n=d.exports.useRef(null);let l=-1;async function F(){var o;if(!u)return;const t=await M(u,l);m({type:l===-1?"reset":"add",payload:t.subscribers}),(o=n.current)==null||o.call(n,t.hasMore),l=t.time}function p(t,{type:c="reset",payload:o}){return c==="reset"?o:[...t,...o]}return d.exports.useEffect(()=>(F(),y),[u]),s(h,{children:[e("div",{className:a(),children:i.map(t=>s("div",{className:a("item"),children:[e(C,{className:a("img"),src:N(t.avatarUrl,100)}),s("div",{children:[e("div",{className:a("title"),children:t.nickname}),t.signature&&e("div",{className:a("subtitle"),children:t.signature})]})]},t.userId))}),e(Q,{ref:n,cb:F})]})},v=({item:u,onItemClick:a})=>{const i=b("radio-list");return s("div",{className:i("item"),children:[e("div",{className:i("ordinal"),children:u.serialNum}),e(C,{className:i("cover"),icon:{hoverDisplay:!0},src:N(u.coverUrl,60),onClick:()=>a==null?void 0:a(u.mainSong.id),onIconClick:()=>a==null?void 0:a(u.mainSong.id)}),e("div",{className:i("name"),children:u.name}),s("div",{className:i("play-count"),children:[e(P,{})," ",u.trackCount]}),s("div",{className:i("like-count"),children:[e(I,{})," ",u.likedCount]}),e("div",{className:i("date"),children:q(u.createTime).format("YYYY-MM-DD")}),e("div",{className:i("duration"),children:R(u.duration)})]})},ce=()=>{const u=b("list"),a=b("radio-list"),i=T(),m=d.exports.useMemo(()=>Number(i.id),[i.id]),n=d.exports.useMemo(()=>!!i.type,[i.type]),[l,F]=d.exports.useState([]),p=d.exports.useMemo(()=>l.sort((r,D)=>r.createTime-D.createTime).slice(0,3),[l]),t=d.exports.useMemo(()=>l.filter(r=>r.programFeeType===5),[l]),c=W(r=>r.djDetail),o=V();async function S(){const r=await U(m);o(L(r.data))}async function x(){const r=await Y(m);F(r.programs)}async function B(r){o(w(r))}function j(){var r;return s(h,{children:[s("div",{className:u("user-info"),children:[e("img",{src:c.dj&&k(N(c.dj.avatarUrl,30)),alt:"avatar"}),e("a",{children:(r=c.dj)==null?void 0:r.nickname})]}),s("div",{className:u("control"),children:[e(E,{compose:!0}),s(E,{children:[e(G,{}),"\u5DF2\u8BA2\u9605(",c.subCount,")"]}),s(E,{children:[e(A,{}),"\u5206\u4EAB(",c.shareCount,")"]})]}),s("div",{className:a("tag"),children:[e("span",{children:c.category}),e("strong",{children:c.desc})]})]})}function O(){var r,D;return s(h,{children:[s("div",{className:a("price"),children:["\xA5",(((r=c==null?void 0:c.feeInfo)==null?void 0:r.originalPrice)||0)/100]}),s("div",{className:a("buttons"),children:[s("button",{className:f(a("button"),"--bg"),children:[e(z,{}),"\u7ACB\u5373\u8D2D\u4E70"]}),s("button",{className:f(a("button"),"--border"),children:[e(P,{}),"\u514D\u8D39\u8BD5\u542C"]}),s(E,{children:[e(A,{}),"\u5206\u4EAB(175)"]})]}),e("div",{className:a("slogan"),children:(D=c.feeInfo)==null?void 0:D.slogan}),e("small",{className:a("brief"),children:"\u6700\u65B0\u4E0A\u67B6"})]})}return d.exports.useEffect(()=>{if(!Number.isNaN(m))return S(),x(),y},[m]),s("div",{className:u(),children:[s("header",{className:u("header"),children:[e(C,{className:u("img"),src:c.picUrl&&N(c.picUrl,200)}),s("div",{className:u("right"),children:[s("div",{className:u("title"),children:[e("span",{children:n?"\u4ED8\u8D39\u7CBE\u54C1":"\u7535\u53F0"}),e("strong",{children:c.name})]}),n?O():j()]})]}),e("section",{className:u("tabs"),children:s(g,{children:[n&&e(g.TabPane,{tab:"\u8BE6\u60C5",children:s("div",{className:a("detail"),children:[e("h3",{className:a("detail-title"),children:"\u7535\u53F0\u5185\u5BB9\u7B80\u4ECB"}),e("p",{children:c.desc}),p.length>0&&s(h,{children:[e("h3",{className:a("detail-title"),children:"\u6700\u8FD1\u66F4\u65B0"}),p.map(r=>e(v,{item:r,onItemClick:B},r.id))]}),t.length>0&&s(h,{children:[e("h3",{className:a("detail-title"),children:"\u514D\u8D39\u8BD5\u542C >"}),t.map(r=>e(v,{item:r,onItemClick:B},r.id))]}),e("h3",{className:f(a("detail-title"),a("detail-notice")),children:"\u8D2D\u4E70\u987B\u77E5"}),s("p",{children:["1. \u672C\u97F3\u9891\u4E3A\u4ED8\u8D39\u8BA2\u9605\u4EA7\u54C1\uFFE512.9/12\u671F\uFF0C\u8D2D\u4E70\u6210\u529F\u540E\u5373\u53EF\u7545\u542C/\u4E0B\u8F7D",e("br",{}),"2. \u8BF7\u5728\u7F51\u6613\u4E91\u97F3\u4E50\u624B\u673AAPP\u652F\u4ED8\u8D2D\u4E70\uFF0C\u8D2D\u4E70\u540E\u652F\u6301\u79FB\u52A8\u3001PC\u3001Web\u7B49\u7AEF\u6536\u542C",e("br",{}),"3. \u8D2D\u4E70\u6210\u529F\u540E\u4E0D\u53EF\u9000\u6B3E\uFF0C\u540C\u65F6\u4E0D\u652F\u6301\u8F6C\u8BA9\uFF0C\u656C\u8BF7\u8C05\u89E3\uFF1B",e("br",{}),"4. \u8D2D\u4E70\u8FC7\u7A0B\u9047\u5230\u4EFB\u4F55\u95EE\u9898\uFF0C\u8BF7\u79C1\u4FE1\u8054\u7CFB@\u4E91\u97F3\u4E50\u5BA2\u670D"]})]})},"0"),s(g.TabPane,{tab:"\u8282\u76EE",children:[s("div",{className:a("control"),children:[s("div",{children:["\u5171",c.programCount,"\u671F"]}),s("div",{className:a("control-right"),children:[e("strong",{children:"\u6392\u5E8F"}),e(H,{className:a("icon")}),e(K,{className:a("icon")})]})]}),l.map(r=>e(v,{item:r,onItemClick:B},r.id))]},"1"),!n&&e(g.TabPane,{tab:"\u8BA2\u9605\u8005",children:e(X,{id:m})},"3")]})})]})};export{ce as default};
