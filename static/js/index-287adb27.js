import{r as t,g as o,j as s}from"./react-fd5b3f8c.js";import{j,av as w,T as M,c as G,aw as R}from"./index-32e1ab72.js";import{C as T}from"./index-4a0558bb.js";import{d as U}from"./lodash-44bc1aaf.js";import{I as A}from"./index-1e5bcb3c.js";import"./vendor-29be4ff8.js";import"./react-router-dom-f202c9ff.js";import"./react-redux-0fe31567.js";const P=()=>{const a=G("cloud-music"),[h,x]=t.exports.useReducer(B,[]),[,y]=t.exports.useState(0),[c,C]=t.exports.useState(0),[u,S]=t.exports.useState(0),[,g]=t.exports.useState(""),F=t.exports.useMemo(()=>c===0?0:u*100/c,[u,c]);let i=0;const d=30,n=t.exports.useRef(null),I=U(r=>{g(r.currentTarget.value)},500);async function p(){var f;const r=await R(i,d),{data:e,maxSize:l,size:v,count:z,hasMore:N}=r,D=i===0?"reset":"add",E=e.map(b=>b.simpleSong);x({type:D,payload:E}),C(m(l)),S(m(v)),y(z),(f=n.current)==null||f.call(n,N),i+=d}function B(r,e){return e.type==="add"?[...r,...e.payload]:e.payload}function m(r){try{let e=BigInt(r);const l=BigInt(1024);return e*=BigInt(10),e/=l**BigInt(3),Number(e)/10}catch(e){return console.error(e),0}}return t.exports.useEffect(()=>{p()},[]),o("div",{children:[o("header",{className:a("header"),children:[o("div",{className:a("capacity"),children:[s("span",{className:a("capacity-title"),children:"\u4E91\u76D8\u5BB9\u91CF"}),s("div",{className:a("ruler"),children:s("div",{style:{width:`${F}%`}})}),o("span",{className:a("capacity-ratio"),children:[u,"G/",c,"G"]}),s("span",{className:a("capacity-description"),children:"\u6B4C\u66F2\u6C38\u4E45\u4FDD\u5B58\uFF0C\u968F\u65F6\u968F\u5730\u591A\u7AEF\u7545\u542C"})]}),o("div",{className:a("control"),children:[s(j,{compose:!0}),s(w,{placeholder:"\u641C\u7D22\u4E91\u76D8\u97F3\u4E50",onInput:I})]})]}),s(M,{columns:T,data:h}),s(A,{ref:n,cb:p})]})};export{P as default};
